{% extends "base.html" %}

{% block content %}
<div class="page-header">
    <h1>‚úèÔ∏è Edit Employee</h1>
    <p>Update employee information</p>
</div>

<div class="form-card">
    <form method="POST" action="{{ url_for('update_employee', emp_id=employee.id) }}" class="form-grid" enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        
        <h3 style="grid-column: span 2; margin: 0 0 15px 0;">Profile Photo</h3>
        
        <div class="form-group" style="grid-column: span 2;">
            {% if employee.photo_path %}
            <div style="margin-bottom: 15px;">
                <img src="{{ url_for('static', filename='../' + employee.photo_path) }}" 
                     alt="Current Photo" 
                     style="max-width: 150px; max-height: 150px; border-radius: 8px; border: 2px solid #ddd;">
                <p style="margin-top: 5px; font-size: 13px; color: #666;">Current Photo</p>
            </div>
            {% endif %}
            <label for="profile_photo">Upload New Photo</label>
            <input type="file" id="profile_photo" name="profile_photo" accept="image/png,image/jpeg,image/jpg,image/gif">
            <small style="color: #666;">Allowed formats: PNG, JPG, JPEG, GIF. Leave empty to keep current photo.</small>
        </div>
        
        <h3 style="grid-column: span 2; margin: 0 0 15px 0;">Personal Information</h3>
        
        <div class="form-group">
            <label for="employee_id">Employee ID *</label>
            <input type="text" id="employee_id" name="employee_id" value="{{ employee.employee_id }}" required>
        </div>
        
        <div class="form-group">
            <label for="first_name">First Name *</label>
            <input type="text" id="first_name" name="first_name" value="{{ employee.first_name }}" required>
        </div>
        
        <div class="form-group">
            <label for="last_name">Last Name *</label>
            <input type="text" id="last_name" name="last_name" value="{{ employee.last_name }}" required>
        </div>
        
        <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" value="{{ employee.email or '' }}">
        </div>
        
        <div class="form-group">
            <label for="phone">Phone</label>
            <input type="text" id="phone" name="phone" value="{{ employee.phone or '' }}">
        </div>
        
        <div class="form-group">
            <label for="mobile">Mobile</label>
            <input type="text" id="mobile" name="mobile" value="{{ employee.mobile or '' }}">
        </div>
        
        <div class="form-group">
            <label for="date_of_birth">Date of Birth</label>
            <input type="date" id="date_of_birth" name="date_of_birth" value="{{ employee.date_of_birth }}">
        </div>
        
        <div class="form-group">
            <label for="gender">Gender</label>
            <select id="gender" name="gender">
                <option value="">Select...</option>
                <option value="Male" {% if employee.gender == 'Male' %}selected{% endif %}>Male</option>
                <option value="Female" {% if employee.gender == 'Female' %}selected{% endif %}>Female</option>
                <option value="Other" {% if employee.gender == 'Other' %}selected{% endif %}>Other</option>
            </select>
        </div>
        
        <h3 style="grid-column: span 2; margin: 20px 0 15px 0;">Employment Information</h3>
        
        <div class="form-group">
            <label for="department_id">Department</label>
            <select id="department_id" name="department_id">
                <option value="">Select...</option>
                {% for dept in departments %}
                <option value="{{ dept.id }}" {% if employee.department_id == dept.id %}selected{% endif %}>{{ dept.name }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label for="position">Position</label>
            <input type="text" id="position" name="position" value="{{ employee.position or '' }}">
        </div>
        
        <div class="form-group">
            <label for="qualification">Qualification</label>
            <input type="text" id="qualification" name="qualification" value="{{ employee.qualification or '' }}" placeholder="e.g., Bachelor's in IT, MBA, Diploma">
        </div>
        
        <div class="form-group">
            <label for="employment_type">Employment Type</label>
            <select id="employment_type" name="employment_type">
                <option value="Full-Time" {% if employee.employment_type == 'Full-Time' %}selected{% endif %}>Full-Time</option>
                <option value="Part-Time" {% if employee.employment_type == 'Part-Time' %}selected{% endif %}>Part-Time</option>
                <option value="Contract" {% if employee.employment_type == 'Contract' %}selected{% endif %}>Contract</option>
                <option value="Temporary" {% if employee.employment_type == 'Temporary' %}selected{% endif %}>Temporary</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="hire_date">Hire Date</label>
            <input type="date" id="hire_date" name="hire_date" value="{{ employee.hire_date }}">
        </div>
        
        <div class="form-group">
            <label for="termination_date">Termination Date</label>
            <input type="date" id="termination_date" name="termination_date" value="{{ employee.termination_date or '' }}">
        </div>
        
        <div class="form-group">
            <label for="salary">Salary (VUV)</label>
            <input type="number" id="salary" name="salary" step="0.01" value="{{ employee.salary or '' }}">
        </div>
        
        <div class="form-group">
            <label for="is_active">Status</label>
            <select id="is_active" name="is_active">
                <option value="1" {% if employee.is_active %}selected{% endif %}>Active</option>
                <option value="0" {% if not employee.is_active %}selected{% endif %}>Inactive</option>
            </select>
        </div>
        
        <h3 style="grid-column: span 2; margin: 20px 0 15px 0;">Contact & Emergency Information</h3>
        
        <div class="form-group">
            <label for="city">City</label>
            <input type="text" id="city" name="city" value="{{ employee.city or '' }}">
        </div>
        
        <div class="form-group" style="grid-column: span 2;">
            <label for="address">Address</label>
            <input type="text" id="address" name="address" value="{{ employee.address or '' }}">
        </div>
        
        <div class="form-group">
            <label for="emergency_contact_name">Emergency Contact Name</label>
            <input type="text" id="emergency_contact_name" name="emergency_contact_name" value="{{ employee.emergency_contact_name or '' }}">
        </div>
        
        <div class="form-group">
            <label for="emergency_contact_phone">Emergency Contact Phone</label>
            <input type="text" id="emergency_contact_phone" name="emergency_contact_phone" value="{{ employee.emergency_contact_phone or '' }}">
        </div>
        
        <div class="form-group" style="grid-column: span 2;">
            <label for="notes">Notes</label>
            <textarea id="notes" name="notes" rows="3">{{ employee.notes or '' }}</textarea>
        </div>
        
        <div class="form-group" style="grid-column: span 2; display: flex; gap: 10px; margin-top: 10px;">
            <button type="submit" class="btn btn-primary">üíæ Update Employee</button>
            <a href="{{ url_for('employees') }}" class="btn btn-secondary">‚ùå Cancel</a>
        </div>
    </form>
</div>

<style>
.form-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
}

.form-group {
    display: flex;
    flex-direction: column;
}

.form-group label {
    margin-bottom: 5px;
    font-weight: 500;
    color: #333;
    font-size: 14px;
}

.form-group input,
.form-group textarea,
.form-group select {
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
}

@media (max-width: 768px) {
    .form-grid {
        grid-template-columns: 1fr;
    }
    
    .form-group[style*="span 2"],
    h3[style*="span 2"] {
        grid-column: span 1 !important;
    }
}
</style>

{% endblock %}
