<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ title or 'Asset Management System' }}</title>
  <link rel="icon" type="image/png" href="/static/asset.png">
  <link rel="shortcut icon" type="image/png" href="/static/asset.png">
  <link rel="apple-touch-icon" href="/static/asset.png">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: {
              50: '#f0f9ff',
              100: '#e0f2fe',
              200: '#bae6fd',
              300: '#7dd3fc',
              400: '#38bdf8',
              500: '#0ea5e9',
              600: '#0284c7',
              700: '#0369a1',
              800: '#075985',
              900: '#0c4a6e',
            },
            sidebar: {
              dark: '#1a1f3a',
              mid: '#2c3e50',
              green: '#1e8449',
            },
            success: '#2ecc71',
            warning: '#f39c12',
            danger: '#e74c3c',
          }
        }
      }
    }
  </script>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  
  <!-- Custom Styles -->
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/styles.css', v='3.7') }}" />
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/notifications.css') }}" />
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/tailwind-enhancements.css') }}" />
</head>
<body>
  <!-- Mobile Menu Toggle -->
  <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Toggle navigation menu">
    â˜°
  </button>
  
  <div class="sidebar">
    <div class="sidebar-header">
      <a href="/" class="logo">
        <img src="/static/asset.png" alt="Vanuatu Bureau of Statistics logo">
      </a>
      <div class="brand">
        <h1>Asset Management</h1>
        <div class="sub">Vanuatu Bureau of Statistics</div>
      </div>
    </div>
    <ul class="sidebar-menu">
  <!-- Dashboard -->
  <li class="menu-item-has-children">
    <a href='#' class="submenu-toggle"><i>ğŸ </i>Dashboard <span class="arrow">â–¼</span></a>
    <ul class="submenu">
      <li><a href='/'><i>ğŸ“Š</i>View Dashboard</a></li>
      <li><a href='/manage-dashboard'><i>âš™ï¸</i>Manage Dashboard</a></li>
    </ul>
  </li>
  
  <!-- Alerts -->
  <li class="menu-item-has-children">
    <a href='#' class="submenu-toggle"><i>ğŸ””</i>Alerts <span class="badge" style="background-color: #dc3545; color: white; padding: 2px 6px; border-radius: 10px; font-size: 10px; margin-left: 5px;">!</span> <span class="arrow">â–¼</span></a>
    <ul class="submenu">
      <li><a href='/alerts/assets-past-due'><i>â°</i>Assets Past Due</a></li>
      <li><a href='/alerts/contracts-expiring'><i>ğŸ“„</i>Contracts Expiring</a></li>
      <li><a href='/alerts/leases-expiring'><i>ğŸ¢</i>Leases Expiring</a></li>
      <li><a href='/alerts/maintenance-due'><i>ğŸ”§</i>Maintenance Due</a></li>
      <li><a href='/alerts/maintenance-overdue'><i>âš ï¸</i>Maintenance Overdue</a></li>
      <li><a href='/alerts/warranties-expiring'><i>ğŸ›¡ï¸</i>Warranties Expiring</a></li>
    </ul>
  </li>
  
  <!-- Assets Management -->
  <li class="menu-item-has-children">
    <a href='#' class="submenu-toggle"><i>ğŸ“¦</i>Assets <span class="arrow">â–¼</span></a>
    <ul class="submenu">
      <li><a href='/assets'><i>ğŸ“‹</i>List of Assets</a></li>
      <li><a href='/add'><i>â•</i>Add an Asset</a></li>
      <li><a href='/update'><i>ğŸ”„</i>Update Quantity</a></li>
      <li><a href='/checkout'><i>ğŸ“¤</i>Check Out</a></li>
      <li><a href='/checkin'><i>ğŸ“¥</i>Check In</a></li>
      <li><a href='/lease'><i>ğŸ“</i>Lease</a></li>
      <li><a href='/lease-return'><i>â†©ï¸</i>Lease Return</a></li>
      <li><a href='/maintenance'><i>ğŸ”§</i>Maintenance</a></li>
      <li><a href='/move'><i>ğŸšš</i>Move</a></li>
      <li><a href='/reserve'><i>ğŸ”–</i>Reserve</a></li>
      <li><a href='/dispose'><i>ğŸ—‘ï¸</i>Dispose</a></li>
    </ul>
  </li>
  
  <!-- Tools -->
  <li class="menu-item-has-children">
    <a href='#' class="submenu-toggle"><i>ğŸ› ï¸</i>Tools <span class="arrow">â–¼</span></a>
    <ul class="submenu">
      <li><a href='/data-quality'><i>ğŸ“Š</i>Data Quality</a></li>
      <li><a href='/import'><i>ğŸ“¥</i>Import Data</a></li>
      <li class="menu-item-has-children">
        <a href='#' class="submenu-toggle"><i>ğŸ“¤</i>Export Data <span class="arrow">â–¼</span></a>
        <ul class="submenu">
          <li><a href='/export/assets'><i>ğŸ“¦</i>Export Assets</a></li>
          <li><a href='/export/users'><i>ğŸ‘¤</i>Export Users</a></li>
          <li><a href='/export/maintenance'><i>ğŸ”§</i>Export Maintenance</a></li>
          <li><a href='/export/transactions'><i>ğŸ’³</i>Export Transactions</a></li>
          <li><a href='/export/all'><i>ï¿½</i>Export All Data</a></li>
        </ul>
      </li>
      <li><a href='/document-gallery'><i>ğŸ“„</i>Document Gallery</a></li>
      <li><a href='/image-gallery'><i>ğŸ–¼ï¸</i>Image Gallery</a></li>
    </ul>
  </li>
  
  <!-- Reports -->
  <li class="menu-item-has-children">
    <a href='#' class="submenu-toggle"><i>ğŸ“Š</i>Reports <span class="arrow">â–¼</span></a>
    <ul class="submenu">
      <li><a href='/reports/automated'><i>ğŸ¤–</i>Automated Report</a></li>
      <li><a href='/reports/custom'><i>âœï¸</i>Custom Report</a></li>
      <li><a href='/reports/inventory'><i>ğŸ“¦</i>Inventory Report</a></li>
      <li><a href='/reports/asset'><i>ğŸ·ï¸</i>Asset Report</a></li>
      <li><a href='/reports/audit'><i>ğŸ”</i>Audit Report</a></li>
      <li><a href='/reports/checkout'><i>ğŸ“¤</i>Check-out Report</a></li>
      <li><a href='/reports/contract'><i>ğŸ“„</i>Contract Report</a></li>
      <li><a href='/reports/depreciation'><i>ğŸ“‰</i>Depreciation Report</a></li>
      <li><a href='/reports/funding'><i>ğŸ’µ</i>Funding Report</a></li>
      <li><a href='/reports/lease-asset'><i>ğŸ“</i>Lease Asset Report</a></li>
      <li><a href='/reports/maintenance'><i>ğŸ”§</i>Maintenance Report</a></li>
      <li><a href='/reports/reservation'><i>ğŸ”–</i>Reservation Report</a></li>
      <li><a href='/reports/status'><i>ğŸ“Š</i>Status Report</a></li>
      <li><a href='/reports/transaction'><i>ğŸ’³</i>Transaction Report</a></li>
      <li><a href='/reports/other'><i>ğŸ“‹</i>Other Report</a></li>
    </ul>
  </li>
  
  <!-- Lists -->
  <li class="menu-item-has-children">
    <a href='#' class="submenu-toggle"><i>ğŸ“‹</i>Lists <span class="arrow">â–¼</span></a>
    <ul class="submenu">
      <li><a href='/lists/assets'><i>ğŸ“¦</i>Lists of Assets</a></li>
      <li><a href='/lists/maintenances'><i>ğŸ”§</i>Lists of Maintenances</a></li>
      <li><a href='/lists/contracts'><i>ğŸ“„</i>Lists of Contracts</a></li>
    </ul>
  </li>
  
  <!-- Advanced Features -->
  <li class="menu-item-has-children">
    <a href='#' class="submenu-toggle"><i>âš™ï¸</i>Advanced <span class="arrow">â–¼</span></a>
    <ul class="submenu">
      <li class="menu-item-has-children">
        <a href='#' class="submenu-toggle"><i>ğŸ“„</i>Contracts/Licenses <span class="arrow">â–¼</span></a>
        <ul class="submenu">
          <li><a href='/contracts/add'><i>â•</i>Add Contract</a></li>
          <li><a href='/contracts/list'><i>ğŸ“‹</i>View All Contracts</a></li>
          <li><a href='/contracts/renewals'><i>â°</i>Upcoming Renewals</a></li>
          <li><a href='/contracts/expired'><i>âš ï¸</i>Expired Contracts</a></li>
          <li><a href='/contracts/licenses'><i>ğŸ”‘</i>Software Licenses</a></li>
        </ul>
      </li>
      <li class="menu-item-has-children">
        <a href='#' class="submenu-toggle"><i>ï¿½</i>Asset Purchase Orders <span class="arrow">â–¼</span></a>
        <ul class="submenu">
          <li><a href='/apo/add'><i>â•</i>Add APO</a></li>
          <li><a href='/apo/list'><i>ğŸ“‹</i>View All APOs</a></li>
        </ul>
      </li>
      <li><a href='/funding'><i>ğŸ’µ</i>Funding</a></li>
    </ul>
  </li>
  
  <!-- Setup & Configuration -->
  <li class="menu-item-has-children">
    <a href='#' class="submenu-toggle"><i>ğŸ”§</i>Setup/Configuration <span class="arrow">â–¼</span></a>
    <ul class="submenu">
      <li><a href='/users'><i>ï¿½</i>Users</a></li>
      <li><a href='/groups'><i>ğŸ”—</i>Groups</a></li>
      <li><a href='/employees'><i>ğŸ‘¨â€ï¿½</i>Employees</a></li>
      <li><a href='/customers'><i>ï¿½</i>Customers</a></li>
      <li><a href='/suppliers'><i>ğŸ¢</i>Suppliers</a></li>
      <li><a href='/company-info'><i>ğŸ¢</i>Company Info</a></li>
      <li><a href='/locations'><i>ğŸ“</i>Locations</a></li>
      <li><a href='/departments'><i>ğŸ›ï¸</i>Departments/Cost Centers</a></li>
      <li><a href='/categories'><i>ğŸ·ï¸</i>Categories</a></li>
      <li><a href='/subcategories'><i>ğŸ“‘</i>Subcategories</a></li>
      <li><a href='/assign-group'><i>ğŸ”—</i>Assign Group</a></li>
      <li><a href='/settings/email'><i>ğŸ“§</i>Email Settings</a></li>
      <li class="submenu-item-has-children">
        <a href='#' class="submenu-toggle-nested"><i>ğŸ’¾</i>Database <span class="arrow-nested">â–¼</span></a>
        <ul class="nested-submenu">
          <li><a href='/database'><i>ğŸ’¾</i>Backup & Restore</a></li>
          <li><a href='/backup-restore'><i>ğŸ”„</i>Legacy Backup/Restore</a></li>
        </ul>
      </li>
      <li class="submenu-item-has-children">
        <a href='#' class="submenu-toggle-nested"><i>ğŸ“</i>Customize Forms <span class="arrow-nested">â–¼</span></a>
        <ul class="nested-submenu">
          <li><a href='/customize-assets-form'><i>ğŸ“¦</i>Assets Form</a></li>
          <li><a href='/customize-customers-form'><i>ğŸ‘¥</i>Customers Form</a></li>
          <li><a href='/customize-maintenance-form'><i>ğŸ”§</i>Maintenance Form</a></li>
          <li><a href='/customize-contracts-form'><i>ğŸ“„</i>Contracts Form</a></li>
        </ul>
      </li>
    </ul>
  </li>
  
  <!-- Help & Support -->
  <li class="menu-item-has-children">
    <a href='#' class="submenu-toggle"><i>ğŸ’¡</i>Help & Support <span class="arrow">â–¼</span></a>
    <ul class="submenu">
      <li><a href='/help/user-guide'><i>ğŸ“–</i>User Guide</a></li>
      <li><a href='/help/documentation'><i>ğŸ“š</i>Documentation</a></li>
      <li><a href='/help/faq'><i>â“</i>FAQ</a></li>
      <li><a href='/help/video-tutorials'><i>ğŸ¥</i>Video Tutorials</a></li>
      <li><a href='/help/contact-support'><i>ğŸ“§</i>Contact Support</a></li>
      <li><a href='/help/system-info'><i>â„¹ï¸</i>System Information</a></li>
      <li><a href='/help/release-notes'><i>ğŸ“‹</i>Release Notes</a></li>
      <li><a href='/help-support'><i>ğŸ‘¨â€ğŸ’»</i>About Developer</a></li>
    </ul>
  </li>
  
  <!-- Developer Tools (Admin Only) -->
  {% if session.get('role') == 'Admin' %}
  <li class="menu-item-has-children">
    <a href='#' class="submenu-toggle"><i>ğŸ› ï¸</i>Developer Tools <span class="arrow">â–¼</span></a>
    <ul class="submenu">
      <li><a href='/developer/code-generator'><i>ğŸ¤–</i>Code Generator</a></li>
    </ul>
  </li>
  {% endif %}
    </ul>
  </div>
  <div class="main-content">
    <div class="topbar">
      <div class="topbar-actions">
        <a class="btn-link" href="/assets"><i>ğŸ“‹</i> Asset List</a>
        <a class="btn-link" href="/add"><i>â•</i> Add Asset</a>
      </div>
      <div class="search-bar">
        <form method="get" action="/" style="flex:1;display:flex;position:relative;">
          <div class="dropdown" style="position:relative;">
            <button type="button" class="dropdown-toggle" style="padding:10px 15px;background-color:#3498db;color:white;border:none;border-radius:5px 0 0 5px;cursor:pointer;font-size:14px;height:40px;display:flex;align-items:center;gap:5px;">
              <span>ğŸ”</span>
              <span style="font-size:10px;">â–¼</span>
            </button>
            <div class="dropdown-menu" style="display:none;position:absolute;top:100%;left:0;background:white;border:1px solid #ddd;border-radius:5px;box-shadow:0 4px 12px rgba(0,0,0,0.15);min-width:200px;z-index:1000;margin-top:5px;">
              <a href="/assets" style="display:block;padding:10px 15px;color:#2c3e50;text-decoration:none;border-bottom:1px solid #ecf0f1;transition:background 0.2s;"><i>ğŸ“‹</i> List of Assets</a>
              <a href="/add" style="display:block;padding:10px 15px;color:#2c3e50;text-decoration:none;border-bottom:1px solid #ecf0f1;transition:background 0.2s;"><i>â•</i> Add an Asset</a>
              <a href="/update" style="display:block;padding:10px 15px;color:#2c3e50;text-decoration:none;border-bottom:1px solid #ecf0f1;transition:background 0.2s;"><i>ğŸ”„</i> Update Quantity</a>
              <a href="/checkout" style="display:block;padding:10px 15px;color:#2c3e50;text-decoration:none;border-bottom:1px solid #ecf0f1;transition:background 0.2s;"><i>ğŸ“¤</i> Check Out</a>
              <a href="/checkin" style="display:block;padding:10px 15px;color:#2c3e50;text-decoration:none;border-bottom:1px solid #ecf0f1;transition:background 0.2s;"><i>ğŸ“¥</i> Check In</a>
              <a href="/lease" style="display:block;padding:10px 15px;color:#2c3e50;text-decoration:none;border-bottom:1px solid #ecf0f1;transition:background 0.2s;"><i>ğŸ“</i> Lease</a>
              <a href="/lease-return" style="display:block;padding:10px 15px;color:#2c3e50;text-decoration:none;border-bottom:1px solid #ecf0f1;transition:background 0.2s;"><i>â†©ï¸</i> Lease Return</a>
              <a href="/maintenance" style="display:block;padding:10px 15px;color:#2c3e50;text-decoration:none;border-bottom:1px solid #ecf0f1;transition:background 0.2s;"><i>ğŸ”§</i> Maintenance</a>
              <a href="/move" style="display:block;padding:10px 15px;color:#2c3e50;text-decoration:none;border-bottom:1px solid #ecf0f1;transition:background 0.2s;"><i>ğŸšš</i> Move</a>
              <a href="/reserve" style="display:block;padding:10px 15px;color:#2c3e50;text-decoration:none;border-bottom:1px solid #ecf0f1;transition:background 0.2s;"><i>ğŸ”–</i> Reserve</a>
              <a href="/dispose" style="display:block;padding:10px 15px;color:#2c3e50;text-decoration:none;transition:background 0.2s;"><i>ğŸ—‘ï¸</i> Dispose</a>
            </div>
          </div>
          <input type="text" placeholder="Search assets, suppliers, or categories..." name="q" value="{{ request.args.get('q','') }}" style="flex:1;padding:10px 15px;border:1px solid #ddd;border-left:none;border-radius:0 5px 5px 0;height:40px;box-sizing:border-box;font-size:14px;">
          <button type="submit" style="position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;color:#999;cursor:pointer;font-size:18px;padding:5px;">ğŸ”</button>
        </form>
      </div>
      <div class="theme-switcher">
        <div class="dropdown">
          <button class="dropdown-toggle theme-btn" id="theme-toggle">
            <span class="theme-icon">ğŸŒ™</span>
          </button>
          <div class="dropdown-menu" id="theme-menu">
            <a href="#" class="theme-option" data-theme="light">â˜€ï¸ Light</a>
            <a href="#" class="theme-option" data-theme="dark">ğŸŒ™ Dark</a>
            <a href="#" class="theme-option" data-theme="auto">ğŸ”„ Auto</a>
          </div>
        </div>
      </div>
      <div class="user-menu">
        {% if session.get('username') %}
          <div class="dropdown">
            <button class="dropdown-toggle" onclick="event.stopPropagation(); this.parentElement.classList.toggle('active');">{{ session.get('username') }} â–¼</button>
            <div class="dropdown-menu">
              <a href="/profile">ğŸ‘¤ My Profile</a>
              <a href="/change-profile">âœï¸ Change Profile</a>
              <a href="/account-details">â„¹ï¸ Account Details</a>
              <div class="dropdown-divider"></div>
              <a href="#" onclick="showKeyboardShortcuts(event)">âŒ¨ï¸ Keyboard Shortcuts</a>
              <div class="dropdown-divider"></div>
              <form method="post" action="/logout" style="display: inline; margin: 0;">
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                <button type="submit" style="background: none; border: none; color: inherit; font: inherit; cursor: pointer; padding: 10px 20px; text-align: left; width: 100%; display: block;">
                  ğŸšª Logout
                </button>
              </form>
            </div>
          </div>
        {% else %}
          <a class="btn-link" href="/login">Login</a>
        {% endif %}
      </div>
    </div>
    
    <!-- Keyboard Shortcuts Modal -->
    <div id="shortcutsModal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);z-index:10000;align-items:center;justify-content:center;">
      <div style="background:white;padding:30px;border-radius:12px;max-width:500px;width:90%;box-shadow:0 10px 40px rgba(0,0,0,0.3);">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
          <h3 style="margin:0;color:#2c3e50;">âŒ¨ï¸ Keyboard Shortcuts</h3>
          <button onclick="hideKeyboardShortcuts()" style="background:none;border:none;font-size:24px;cursor:pointer;color:#95a5a6;">&times;</button>
        </div>
        <div style="display:grid;gap:12px;">
          <div style="display:flex;justify-content:space-between;padding:10px;background:#f8f9fa;border-radius:6px;">
            <span style="color:#7f8c8d;">Add Asset</span>
            <kbd style="background:#fff;padding:4px 8px;border-radius:4px;border:1px solid #ddd;font-family:monospace;">Alt + A</kbd>
          </div>
          <div style="display:flex;justify-content:space-between;padding:10px;background:#f8f9fa;border-radius:6px;">
            <span style="color:#7f8c8d;">Asset List</span>
            <kbd style="background:#fff;padding:4px 8px;border-radius:4px;border:1px solid #ddd;font-family:monospace;">Alt + L</kbd>
          </div>
          <div style="display:flex;justify-content:space-between;padding:10px;background:#f8f9fa;border-radius:6px;">
            <span style="color:#7f8c8d;">Dashboard</span>
            <kbd style="background:#fff;padding:4px 8px;border-radius:4px;border:1px solid #ddd;font-family:monospace;">Alt + H</kbd>
          </div>
          <div style="display:flex;justify-content:space-between;padding:10px;background:#f8f9fa;border-radius:6px;">
            <span style="color:#7f8c8d;">Focus Search</span>
            <kbd style="background:#fff;padding:4px 8px;border-radius:4px;border:1px solid #ddd;font-family:monospace;">Alt + S</kbd>
          </div>
        </div>
        <div style="margin-top:20px;padding-top:20px;border-top:1px solid #ecf0f1;text-align:center;">
          <button onclick="hideKeyboardShortcuts()" style="background:linear-gradient(135deg, #f9d423 0%, #4ca1af 50%, #2ecc71 100%);color:white;border:none;padding:10px 30px;border-radius:6px;cursor:pointer;font-weight:600;">Got it!</button>
        </div>
      </div>
    </div>
    
    <div class="container">
      {% with messages = get_flashed_messages(with_categories=True) %}
        {% if messages %}
          <!-- Flash messages will be shown as toast notifications by our JS -->
          {% for category, msg in messages %}
            <div class="flash-message d-none" data-category="{{ category }}">{{ msg }}</div>
          {% endfor %}
        {% endif %}
      {% endwith %}
      {% block content %}{% endblock %}
    </div>
    
    <!-- Footer Signature -->
    <footer style="background:linear-gradient(135deg, #1a1f3a 0%, #2c3e50 50%, #1e8449 100%);color:white;padding:30px 20px;margin-top:50px;border-top:4px solid #2ecc71;box-shadow:0 -4px 20px rgba(0,0,0,0.1);">
      <div style="max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:20px;">
        <div style="display:flex;align-items:center;gap:15px;">
          <img src="/static/asset.png" alt="VBOS Logo" style="width:60px;height:60px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.3);">
          <div>
            <h3 style="margin:0;font-size:20px;font-weight:700;">Vanuatu Bureau Of Statistics</h3>
            <p style="margin:5px 0 0 0;font-size:14px;opacity:0.9;">Asset Management System</p>
            <p style="margin:5px 0 0 0;font-size:13px;font-style:italic;opacity:0.85;">"Better Data, Better Decision"</p>
          </div>
        </div>
        <div style="text-align:right;">
          <p style="margin:0;font-size:13px;opacity:0.9;">Â© 2025 VBOS. All rights reserved.</p>
          <p style="margin:5px 0 0 0;font-size:12px;opacity:0.8;">Port Vila, Vanuatu</p>
        </div>
      </div>
    </footer>
  </div>
  
  <!-- Print Header (only visible when printing) -->
  <div class="print-header-text" style="display:none;">
    <h1>Vanuatu Bureau Of Statistics</h1>
    <p>Asset Management System</p>
    <p class="slogan">"Better Data, Better Decision"</p>
  </div>
  
  <!-- Back to Top Button -->
  <button class="back-to-top" id="backToTop" onclick="scrollToTop()" aria-label="Back to top">
    â†‘
  </button>
  
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
    <div class="loading-text">Loading...</div>
  </div>
  
  <!-- Back to Top Button -->
  <button class="back-to-top" id="back-to-top" aria-label="Back to top">
    â†‘
  </button>
  
  <script>
    // Back to top button
    const backToTopBtn = document.getElementById('backToTop');
    
    window.addEventListener('scroll', function() {
      if (window.pageYOffset > 300) {
        backToTopBtn.classList.add('show');
      } else {
        backToTopBtn.classList.remove('show');
      }
    });
    
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    // Form submission loading state
    document.addEventListener('DOMContentLoaded', function() {
      const forms = document.querySelectorAll('form');
      const loadingOverlay = document.getElementById('loadingOverlay');
      
      forms.forEach(form => {
        form.addEventListener('submit', function(e) {
          // Skip if form has onsubmit that returns false
          if (form.hasAttribute('onsubmit')) {
            const onsubmit = form.getAttribute('onsubmit');
            if (onsubmit.includes('return false') || onsubmit.includes('confirm')) {
              return;
            }
          }
          
          // Show loading overlay
          if (loadingOverlay) {
            loadingOverlay.classList.add('active');
          }
          
          // Disable submit buttons to prevent double submission
          const submitBtns = form.querySelectorAll('[type="submit"]');
          submitBtns.forEach(btn => {
            btn.disabled = true;
            btn.style.opacity = '0.6';
            btn.style.cursor = 'not-allowed';
          });
        });
      });
    });
  </script>
  
  <script>
    // Mobile menu toggle
    document.addEventListener('DOMContentLoaded', function() {
      const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
      const sidebar = document.querySelector('.sidebar');
      const mainContent = document.querySelector('.main-content');
      
      if (mobileMenuToggle && sidebar) {
        mobileMenuToggle.addEventListener('click', function() {
          sidebar.classList.toggle('mobile-open');
          this.textContent = sidebar.classList.contains('mobile-open') ? 'âœ•' : 'â˜°';
        });
        
        // Close sidebar when clicking outside on mobile
        mainContent.addEventListener('click', function(e) {
          if (window.innerWidth <= 768 && sidebar.classList.contains('mobile-open')) {
            sidebar.classList.remove('mobile-open');
            mobileMenuToggle.textContent = 'â˜°';
          }
        });
        
        // Close sidebar when clicking a menu item on mobile
        const menuLinks = sidebar.querySelectorAll('a');
        menuLinks.forEach(link => {
          link.addEventListener('click', function() {
            if (window.innerWidth <= 768) {
              sidebar.classList.remove('mobile-open');
              mobileMenuToggle.textContent = 'â˜°';
            }
          });
        });
      }
      
      // Keyboard shortcuts
      document.addEventListener('keydown', function(e) {
        // Alt + A = Add Asset
        if (e.altKey && e.key === 'a') {
          e.preventDefault();
          window.location.href = '/add';
        }
        // Alt + L = Asset List
        if (e.altKey && e.key === 'l') {
          e.preventDefault();
          window.location.href = '/assets';
        }
        // Alt + H = Home/Dashboard
        if (e.altKey && e.key === 'h') {
          e.preventDefault();
          window.location.href = '/';
        }
        // Alt + S = Focus Search
        if (e.altKey && e.key === 's') {
          e.preventDefault();
          const searchInput = document.querySelector('.search-bar input[type="text"]');
          if (searchInput) searchInput.focus();
        }
      });
      
      // Add smooth scroll behavior
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          const href = this.getAttribute('href');
          if (href !== '#') {
            e.preventDefault();
            const target = document.querySelector(href);
            if (target) {
              target.scrollIntoView({ behavior: 'smooth' });
            }
          }
        });
      });
      
      // Auto-hide flash messages after 5 seconds
      const messages = document.querySelectorAll('.message');
      messages.forEach(message => {
        setTimeout(() => {
          message.style.transition = 'opacity 0.5s, transform 0.5s';
          message.style.opacity = '0';
          message.style.transform = 'translateY(-20px)';
          setTimeout(() => message.remove(), 500);
        }, 5000);
      });
    });
  </script>
  
  <script>
    // Keyboard shortcuts modal
    function showKeyboardShortcuts(e) {
      e.preventDefault();
      const modal = document.getElementById('shortcutsModal');
      modal.style.display = 'flex';
    }
    
    function hideKeyboardShortcuts() {
      const modal = document.getElementById('shortcutsModal');
      modal.style.display = 'none';
    }
    
    // Close modal on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        hideKeyboardShortcuts();
      }
    });
    
    // Close modal when clicking outside
    document.getElementById('shortcutsModal')?.addEventListener('click', function(e) {
      if (e.target === this) {
        hideKeyboardShortcuts();
      }
    });
  </script>
  
  <script>
    // Theme switcher functionality
    const themeToggle = document.getElementById('theme-toggle');
    const themeMenu = document.getElementById('theme-menu');
    const themeOptions = document.querySelectorAll('.theme-option');
    const themeIcon = document.querySelector('.theme-icon');
    
    // Load saved theme or default to auto
    let currentTheme = localStorage.getItem('theme') || 'auto';
    applyTheme(currentTheme);
    
    // Theme option selection
    themeOptions.forEach(option => {
      option.addEventListener('click', (e) => {
        e.preventDefault();
        const theme = option.dataset.theme;
        currentTheme = theme;
        localStorage.setItem('theme', theme);
        applyTheme(theme);
      });
    });
    
    function applyTheme(theme) {
      const root = document.documentElement;
      
      if (theme === 'auto') {
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        root.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
        themeIcon.textContent = 'ğŸ”„';
      } else {
        root.setAttribute('data-theme', theme);
        themeIcon.textContent = theme === 'dark' ? 'ğŸŒ™' : 'â˜€ï¸';
      }
      
      // Highlight active option
      themeOptions.forEach(opt => {
        opt.classList.toggle('active', opt.dataset.theme === theme);
      });
    }
    
    // Listen for system theme changes in auto mode
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
      if (currentTheme === 'auto') {
        applyTheme('auto');
      }
    });
  </script>
  <script>
    // Sidebar submenu toggle
    document.querySelectorAll('.submenu-toggle').forEach(toggle => {
      toggle.addEventListener('click', function(e) {
        e.preventDefault();
        const parent = this.parentElement;
        parent.classList.toggle('active');
      });
    });
    
    // Nested submenu toggle
    document.querySelectorAll('.submenu-toggle-nested').forEach(toggle => {
      toggle.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        const parent = this.parentElement;
        parent.classList.toggle('active');
      });
    });
    
    // Search dropdown toggle
    document.addEventListener('DOMContentLoaded', function() {
      const searchDropdownToggle = document.querySelector('.search-bar .dropdown-toggle');
      const searchDropdownMenu = document.querySelector('.search-bar .dropdown-menu');
      
      if (searchDropdownToggle && searchDropdownMenu) {
        searchDropdownToggle.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          searchDropdownMenu.style.display = searchDropdownMenu.style.display === 'block' ? 'none' : 'block';
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
          if (!e.target.closest('.search-bar .dropdown')) {
            searchDropdownMenu.style.display = 'none';
          }
        });
        
        // Add hover effects to menu items
        const menuItems = searchDropdownMenu.querySelectorAll('a');
        menuItems.forEach(item => {
          item.addEventListener('mouseenter', function() {
            this.style.backgroundColor = '#ecf0f1';
          });
          item.addEventListener('mouseleave', function() {
            this.style.backgroundColor = 'white';
          });
        });
      }
    });
  </script>
  <script>
    // Mobile menu toggle functionality
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const sidebar = document.querySelector('.sidebar');
    const mainContent = document.querySelector('.main-content');
    
    if (mobileMenuToggle) {
      mobileMenuToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        sidebar.classList.toggle('mobile-open');
        this.textContent = sidebar.classList.contains('mobile-open') ? 'âœ•' : 'â˜°';
      });
      
      // Close menu when clicking outside
      document.addEventListener('click', function(e) {
        if (sidebar.classList.contains('mobile-open') && 
            !sidebar.contains(e.target) && 
            !mobileMenuToggle.contains(e.target)) {
          sidebar.classList.remove('mobile-open');
          mobileMenuToggle.textContent = 'â˜°';
        }
      });
      
      // Close menu when clicking a menu link
      const menuLinks = sidebar.querySelectorAll('a');
      menuLinks.forEach(link => {
        link.addEventListener('click', function() {
          if (window.innerWidth <= 768) {
            sidebar.classList.remove('mobile-open');
            mobileMenuToggle.textContent = 'â˜°';
          }
        });
      });
    }
  </script>
  <script>
    // Back to top button functionality
    const backToTopButton = document.getElementById('back-to-top');
    
    if (backToTopButton) {
      // Show button when scrolling down
      window.addEventListener('scroll', () => {
        if (window.pageYOffset > 300) {
          backToTopButton.style.display = 'flex';
        } else {
          backToTopButton.style.display = 'none';
        }
      });
      
      // Scroll to top on click
      backToTopButton.addEventListener('click', () => {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });
    }
  </script>
  
  <!-- Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  
  <!-- Notification System -->
  <script src="{{ url_for('static', filename='js/notifications.js') }}"></script>
</body>
</html>
