{% extends 'base.html' %}

{% block content %}
<h2>System Status Report</h2>
<p style="color:#7f8c8d;">Overall system status and health report</p>

<div style="background:#fff;padding:24px;border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,.08);margin-top:20px;">
  <h3>System Overview</h3>
  <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:30px;">
    <div style="background:#3498db;padding:20px;border-radius:8px;text-align:center;color:white;">
      <h4 style="margin:0;font-size:14px;opacity:0.9;">Total Assets</h4>
      <p style="margin:10px 0 0;font-size:36px;font-weight:bold;">{{ status.total_assets }}</p>
    </div>
    <div style="background:#27ae60;padding:20px;border-radius:8px;text-align:center;color:white;">
      <h4 style="margin:0;font-size:14px;opacity:0.9;">Total Value</h4>
      <p style="margin:10px 0 0;font-size:28px;font-weight:bold;">VT{{ '%.0f'|format(status.total_value) }}</p>
    </div>
    <div style="background:#e67e22;padding:20px;border-radius:8px;text-align:center;color:white;">
      <h4 style="margin:0;font-size:14px;opacity:0.9;">Users</h4>
      <p style="margin:10px 0 0;font-size:36px;font-weight:bold;">{{ status.total_users }}</p>
    </div>
    <div style="background:#9b59b6;padding:20px;border-radius:8px;text-align:center;color:white;">
      <h4 style="margin:0;font-size:14px;opacity:0.9;">Suppliers</h4>
      <p style="margin:10px 0 0;font-size:36px;font-weight:bold;">{{ status.total_suppliers }}</p>
    </div>
  </div>

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;">
    <div>
      <h3>Low Stock Alerts</h3>
      {% if status.low_stock_count > 0 %}
        <div style="background:#fff3cd;padding:15px;border-radius:8px;border-left:4px solid #ffc107;">
          <p style="margin:0;color:#856404;"><strong>{{ status.low_stock_count }}</strong> items below threshold</p>
        </div>
        <table style="margin-top:15px;">
          <thead>
            <tr>
              <th>Asset</th>
              <th>Quantity</th>
              <th>Threshold</th>
            </tr>
          </thead>
          <tbody>
            {% for name, item in status.low_stock_items %}
            <tr>
              <td>{{ name }}</td>
              <td style="color:#e74c3c;font-weight:600;">{{ item.quantity }}</td>
              <td>{{ item.low_stock_threshold }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% if status.low_stock_count > 5 %}
          <p style="margin-top:10px;color:#7f8c8d;"><small>... and {{ status.low_stock_count - 5 }} more</small></p>
        {% endif %}
      {% else %}
        <div style="background:#d4edda;padding:15px;border-radius:8px;border-left:4px solid #28a745;">
          <p style="margin:0;color:#155724;">âœ“ All items above threshold</p>
        </div>
      {% endif %}
    </div>

    <div>
      <h3>Recent Activity (30 days)</h3>
      {% if status.recent_activity %}
        <table>
          <thead>
            <tr>
              <th>Action</th>
              <th>Count</th>
            </tr>
          </thead>
          <tbody>
            {% for action, count in status.recent_activity.items() %}
            <tr>
              <td>{{ action|capitalize }}</td>
              <td><strong>{{ count }}</strong></td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p style="color:#7f8c8d;">No recent activity recorded.</p>
      {% endif %}
    </div>
  </div>

  <div style="margin-top:30px;padding:20px;background:#ecf0f1;border-radius:8px;">
    <h4 style="margin:0 0 10px 0;color:#2c3e50;">System Status</h4>
    <p style="margin:5px 0;color:#27ae60;"><strong>âœ“ Database:</strong> Connected</p>
    <p style="margin:5px 0;color:#27ae60;"><strong>âœ“ Application:</strong> Running</p>
    <p style="margin:5px 0;color:#7f8c8d;"><strong>ðŸ“… Report Generated:</strong> {{ "now"|date("Y-m-d H:i:s") }}</p>
  </div>
</div>
{% endblock %}
